<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ECã‚µã‚¤ãƒˆæ¨ªæ–­æ¤œç´¢ãƒ„ãƒ¼ãƒ«</title>
  <!-- Tailwind CSS (UIç”¨) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Vue 3 (ãƒ­ã‚¸ãƒƒã‚¯ç”¨) -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
    }

    .site-card {
      transition: all 0.2s ease;
    }

    .site-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
  </style>
</head>

<body>

  <div id="app" class="min-h-screen p-4 md:p-8 max-w-4xl mx-auto">

    <!-- Header -->
    <header class="mb-8 text-center">
      <h1 class="text-3xl font-bold text-gray-800 mb-2">ECã‚µã‚¤ãƒˆæ¨ªæ–­æ¤œç´¢ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
      <p class="text-gray-600 text-sm">å•†å“åã¨ä¾¡æ ¼ã‚’å…¥ã‚Œã‚‹ã ã‘ã§ã€ãƒã‚¤ã‚ºã‚’é™¤å»ã—ãŸæ¤œç´¢ãƒªãƒ³ã‚¯ã‚’ä¸€æ‹¬ç”Ÿæˆã—ã¾ã™ã€‚</p>
    </header>

    <!-- Input Section -->
    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <!-- Keyword Input -->
        <div>
          <label class="block text-sm font-bold text-gray-700 mb-2">
            å•†å“åãƒ»å‹ç•ª <span class="text-red-500">*</span>
          </label>
          <input type="text" v-model="keyword" placeholder="ä¾‹: WH-1000XM5, PlayStation 5"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition">
        </div>

        <!-- Price Input -->
        <div>
          <label class="block text-sm font-bold text-gray-700 mb-2">
            åŸºæº–ä¾¡æ ¼ (å††)
          </label>
          <input type="number" v-model.number="targetPrice" placeholder="ä¾‹: 40000"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition">
          <p class="text-xs text-gray-500 mt-1">
            â€»ã“ã®ä¾¡æ ¼ã‚’åŸºæº–ã«æœ€ä½ä¾¡æ ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨ˆç®—ã—ã¾ã™
          </p>
        </div>
      </div>

      <hr class="border-gray-200 my-4">

      <!-- Options Section -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Filter Option -->
        <div>
          <label class="block text-sm font-bold text-gray-700 mb-2">ãƒã‚¤ã‚ºé™¤å»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</label>
          <div class="flex items-center space-x-2 bg-gray-50 p-3 rounded-lg border border-gray-200">
            <input type="checkbox" id="priceFilter" v-model="enablePriceFilter"
              class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500">
            <label for="priceFilter" class="text-sm text-gray-700 cursor-pointer select-none">
              åŸºæº–ä¾¡æ ¼ã® <span class="font-bold text-red-500">-5%</span> ã‚’ä¸‹é™ã«è¨­å®š
            </label>
          </div>
          <p v-if="enablePriceFilter && computedMinPrice > 0" class="text-xs text-blue-600 mt-1 ml-1">
            ç¾åœ¨ã®è¨­å®š: {{ computedMinPrice.toLocaleString() }}å††ä»¥ä¸Šã‚’æ¤œç´¢
          </p>
        </div>

        <!-- Sort Option -->
        <div>
          <label class="block text-sm font-bold text-gray-700 mb-2">ä¸¦ã³é †</label>
          <div class="flex space-x-4 bg-gray-50 p-3 rounded-lg border border-gray-200">
            <label class="flex items-center space-x-2 cursor-pointer">
              <input type="radio" v-model="sortOrder" value="default" class="text-blue-600 focus:ring-blue-500">
              <span class="text-sm">æ¨™æº–</span>
            </label>
            <label class="flex items-center space-x-2 cursor-pointer">
              <input type="radio" v-model="sortOrder" value="asc" class="text-blue-600 focus:ring-blue-500">
              <span class="text-sm">å®‰ã„é †</span>
            </label>
            <label class="flex items-center space-x-2 cursor-pointer">
              <input type="radio" v-model="sortOrder" value="desc" class="text-blue-600 focus:ring-blue-500">
              <span class="text-sm">é«˜ã„é †</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Results Section -->
    <div v-if="keyword" class="grid grid-cols-1 gap-4">
      <h2 class="text-xl font-bold text-gray-800 mb-2 flex items-center">
        <span class="mr-2">ğŸ”</span> ç”Ÿæˆã•ã‚ŒãŸãƒªãƒ³ã‚¯
      </h2>

      <div v-for="site in sites" :key="site.name" class="site-card bg-white rounded-lg shadow p-4 border-l-4"
        :class="site.borderColor">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
          <div class="flex-1 w-full">
            <div class="flex items-center justify-between mb-1">
              <h3 class="font-bold text-lg text-gray-800">{{ site.name }}</h3>
              <span class="text-xs px-2 py-1 rounded bg-gray-100 text-gray-600 border">
                {{ sortLabel }}
              </span>
            </div>
            <div class="bg-gray-50 p-2 rounded text-xs text-gray-500 font-mono break-all mb-3 border">
              {{ site.url }}
            </div>
          </div>
          <div class="flex-shrink-0 w-full md:w-auto">
            <a :href="site.url" target="_blank" rel="noopener noreferrer"
              class="block w-full md:w-auto text-center px-6 py-3 text-white rounded-lg font-bold shadow transition hover:opacity-90"
              :class="site.btnColor">
              æ¤œç´¢ã™ã‚‹ â†—
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div v-else class="text-center py-12 bg-white rounded-xl shadow-sm border border-dashed border-gray-300">
      <div class="text-4xl mb-4">ğŸ‘†</div>
      <h3 class="text-lg font-bold text-gray-500">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h3>
      <p class="text-gray-400 text-sm mt-2">å…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•çš„ã«å„ã‚µã‚¤ãƒˆã®URLãŒç”Ÿæˆã•ã‚Œã¾ã™</p>
    </div>

  </div>

  <script>
    const { createApp, ref, computed } = Vue;

    createApp({
      setup() {
        // State
        const keyword = ref('');
        const targetPrice = ref('');
        const enablePriceFilter = ref(true); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆON
        const sortOrder = ref('default'); // default, asc, desc

        // Computed: æœ€ä½ä¾¡æ ¼ã®è¨ˆç®— (5% OFF)
        const computedMinPrice = computed(() => {
          if (!targetPrice.value) return 0;
          // 5%å¼•ã„ãŸä¾¡æ ¼ (æ•´æ•°)
          return Math.floor(targetPrice.value * 0.95);
        });

        // Computed: ä¸¦ã³é †ã®ãƒ©ãƒ™ãƒ«è¡¨ç¤ºç”¨
        const sortLabel = computed(() => {
          if (sortOrder.value === 'asc') return 'å®‰ã„é †';
          if (sortOrder.value === 'desc') return 'é«˜ã„é †';
          return 'æ¨™æº–';
        });

        // Computed: ã‚µã‚¤ãƒˆã”ã¨ã®URLç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
        const sites = computed(() => {
          const k = encodeURIComponent(keyword.value.trim());
          const min = enablePriceFilter.value ? computedMinPrice.value : '';

          return [
            // Amazon
            {
              name: 'Amazon.co.jp',
              borderColor: 'border-yellow-500',
              btnColor: 'bg-yellow-500',
              url: (() => {
                let url = `https://www.amazon.co.jp/s?k=${k}`;
                // Amazonã®ä¸¦ã³é †
                if (sortOrder.value === 'asc') url += '&s=price-asc-rank';
                if (sortOrder.value === 'desc') url += '&s=price-desc-rank';
                // Amazonã®æœ€ä½ä¾¡æ ¼ (rhãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãªã„ç°¡æ˜“çš„ãªlow-priceã‚¯ã‚¨ãƒª)
                if (min) url += `&low-price=${min}`;
                return url;
              })()
            },
            // æ¥½å¤©å¸‚å ´
            {
              name: 'æ¥½å¤©å¸‚å ´',
              borderColor: 'border-red-600',
              btnColor: 'bg-red-600',
              url: (() => {
                let url = `https://search.rakuten.co.jp/search/mall/${k}/`;
                // æ¥½å¤©ã®æœ€ä½ä¾¡æ ¼
                if (min) url += `?min=${min}`;
                else url += `?`; // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é€£çµç”¨

                // æ¥½å¤©ã®ä¸¦ã³é † (s=2:å®‰ã„é †, s=3:é«˜ã„é †)
                if (sortOrder.value === 'asc') url += '&s=2';
                if (sortOrder.value === 'desc') url += '&s=3';
                return url;
              })()
            },
            // Yahoo!ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°
            {
              name: 'Yahoo!ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°',
              borderColor: 'border-blue-600',
              btnColor: 'bg-blue-600',
              url: (() => {
                let url = `https://shopping.yahoo.co.jp/search?p=${k}`;
                // Yahooã®æœ€ä½ä¾¡æ ¼ (pf)
                if (min) url += `&pf=${min}`;
                // Yahooã®ä¸¦ã³é † (ãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®š: å®‰ã„é † X=12, é«˜ã„é † X=13)
                if (sortOrder.value === 'asc') url += '&X=12';
                if (sortOrder.value === 'desc') url += '&X=13';
                return url;
              })()
            },
            // ä¾¡æ ¼.com
            {
              name: 'ä¾¡æ ¼.com',
              borderColor: 'border-blue-900',
              btnColor: 'bg-blue-900',
              url: (() => {
                // åŸºæœ¬URL (search.kakaku.com ã«å¤‰æ›´)
                let url = `https://search.kakaku.com/${k}/`;

                // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é…åˆ—ã‚’ä½œæˆã—ã¦çµåˆ
                let params = [];

                // ä¸¦ã³é † (sort=priceb:å®‰ã„é †, sort=pricet:é«˜ã„é †)
                if (sortOrder.value === 'asc') params.push('sort=priceb');
                else if (sortOrder.value === 'desc') params.push('sort=pricet');

                // æœ€ä½ä¾¡æ ¼ (minp)
                if (min) params.push(`minp=${min}`);

                // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã®ã¿çµåˆ
                if (params.length > 0) {
                  url += '?' + params.join('&');
                }
                return url;
              })()
            },
            // Qoo10 (æ–°è¦è¿½åŠ )
            {
              name: 'Qoo10',
              borderColor: 'border-red-400',
              btnColor: 'bg-red-400',
              url: (() => {
                // Qoo10ã¯ãƒ‘ã‚¹ã«ã‚‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å½¢å¼
                // ä¾‹: https://www.qoo10.jp/s/G6030?keyword=G6030...
                let url = `https://www.qoo10.jp/s/${k}?keyword=${k}`;

                // Qoo10ã®æœ€ä½ä¾¡æ ¼ (priceMin)
                if (min) url += `&priceMin=${min}`;

                // Qoo10ã®ä¸¦ã³é † (SELL_PRICE_ASC / SELL_PRICE_DESC)
                if (sortOrder.value === 'asc') url += '&sortType=SELL_PRICE_ASC';
                if (sortOrder.value === 'desc') url += '&sortType=SELL_PRICE_DESC';

                return url;
              })()
            },
            // ãƒ¡ãƒ«ã‚«ãƒª
            {
              name: 'ãƒ¡ãƒ«ã‚«ãƒª',
              borderColor: 'border-red-500',
              btnColor: 'bg-red-500',
              url: (() => {
                let url = `https://jp.mercari.com/search?keyword=${k}`;
                // ãƒ¡ãƒ«ã‚«ãƒªã®æœ€ä½ä¾¡æ ¼
                if (min) url += `&price_min=${min}`;
                // ãƒ¡ãƒ«ã‚«ãƒªã®ä¸¦ã³é †
                if (sortOrder.value === 'asc') url += '&sort=price&order=asc';
                if (sortOrder.value === 'desc') url += '&sort=price&order=desc';
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€Œè²©å£²ä¸­ã®ã¿ã€ã‚’ONã«ã™ã‚‹å ´åˆ: &status=on_sale
                url += '&status=on_sale';
                return url;
              })()
            }
          ];
        });

        return {
          keyword,
          targetPrice,
          enablePriceFilter,
          sortOrder,
          computedMinPrice,
          sortLabel,
          sites
        };
      }
    }).mount('#app');
  </script>
</body>

</html>